

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>内联函数 &mdash; SAC参考手册 4.0-dev 文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../../genindex/" />
    <link rel="search" title="搜索" href="../../search/" />
    <link rel="next" title="SAC 宏" href="../macros/" />
    <link rel="prev" title="黑板变量" href="../blackboard-variables/" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../" class="icon icon-home"> SAC参考手册
          

          
          </a>

          
            
            
              <div class="version">
                4.0-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/">SAC 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../basic/">SAC 基础</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fileformat/">SAC 文件格式</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-process/">SAC 数据处理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graphics/">SAC 图像</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">SAC 编程</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro-to-sac-programming/">SAC 宏简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../header-variables/">引用头段变量值</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blackboard-variables/">黑板变量</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">内联函数</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">算术运算符</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">常规算术运算函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">字符串操作函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">其他函数</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../macros/">SAC 宏</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../call-in-script/">脚本中调用 SAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../libs/">SAC 函数库</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sacio/">SAC I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/">SAC 相关工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tricks-and-traps/">SAC 技巧与陷阱</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../commands/">SAC 命令</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sss/">SSS 信号叠加子程序</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spe/">SPE 谱估计子程序</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/messages/">错误与警告</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/resp/">仪器响应</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/data-fetch/">数据获取</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/naming-convections/">数据命名规则</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/changelog/">文档更新历史</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">SAC参考手册</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../">Docs</a> &raquo;</li>
        
          <li><a href="../">SAC 编程</a> &raquo;</li>
        
      <li>内联函数</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/seisman/SAC_Docs_zh/blob/master/source/macros/inline-functions.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>内联函数<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<p>内联函数是 SAC 实现的一些函数，其可以在 SAC 命令中使用。在执行命令时，内联函数会首先被调用，内联函数的结果将替代命令中的内联函数的位置。</p>
<p>SAC 提供了如下几类内联函数：</p>
<ul class="simple">
<li>算术运算符；</li>
<li>常规算术运算函数；</li>
<li>字符串操作函数；</li>
<li>其他函数；</li>
</ul>
<p>所有的内联函数的共同形式是：“<code class="docutils literal notranslate"><span class="pre">(func)</span></code>”，其中 <code class="docutils literal notranslate"><span class="pre">func</span></code> 为内联函数名。某种程度上，内联函数与前面说到头段变量（“<code class="docutils literal notranslate"><span class="pre">&amp;</span> <span class="pre">&amp;</span></code>”）和黑板变量（“<code class="docutils literal notranslate"><span class="pre">%</span> <span class="pre">%</span></code>”）类似，可以认为是通过“<code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">)</span></code>”引用了内联函数的结果或值。</p>
<p>内联函数支持嵌套，目前最多可以嵌套10层。</p>
<div class="section" id="id2">
<h2>算术运算符<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>算术运算符即常规的加减乘除运算符，但又有不同，其一般形式如下：</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span> <span class="n">number</span> <span class="n">operator</span> <span class="n">number</span> <span class="p">)</span>
</pre></div>
</div>
<p>所有的操作数都被认为是实型的，所有的算术运算都按照双精度浮点型进行运算；</p>
<p>SAC支持的操作符是包括：“<code class="docutils literal notranslate"><span class="pre">+</span>&#160; <span class="pre">-</span>&#160; <span class="pre">*</span>&#160; <span class="pre">/</span>&#160; <span class="pre">**</span></code>”。</p>
<p>看几个简单的例子:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAC</span><span class="o">&gt;</span> <span class="n">echo</span> <span class="n">on</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var1</span> <span class="mi">4</span><span class="o">+</span><span class="mi">7</span>             <span class="c1"># 忘记加括号了！“4+7”被当成了字符串</span>
 <span class="n">setbb</span> <span class="n">var1</span> <span class="mi">4</span><span class="o">+</span><span class="mi">7</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var2</span> <span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span>
 <span class="n">setbb</span> <span class="n">var2</span> <span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var2</span> <span class="mi">11</span>             <span class="c1"># 4+7=11</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var3</span> <span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>         <span class="c1"># 优先级正确</span>
 <span class="n">setbb</span> <span class="n">var3</span> <span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var3</span> <span class="mf">6.33333</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var4</span> <span class="p">((</span><span class="mi">4</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>       <span class="c1"># 括号改变优先级</span>
 <span class="n">setbb</span> <span class="n">var4</span> <span class="p">((</span><span class="mi">4</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>           <span class="c1"># 可以看作是内联函数的嵌套</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var4</span> <span class="mf">3.66667</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var1</span> <span class="p">(</span> <span class="p">(</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">7</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">3</span> <span class="p">)</span>   <span class="c1"># 支持空格</span>
 <span class="n">setbb</span> <span class="n">var1</span> <span class="p">(</span> <span class="p">(</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">7</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">3</span> <span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var1</span> <span class="mf">3.66667</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2>常规算术运算函数<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>SAC 提供了20个常规算术运算函数，其基本形式为“<code class="docutils literal notranslate"><span class="pre">(func</span> <span class="pre">arg1</span> <span class="pre">arg2</span> <span class="pre">...)</span></code>”。具体函数如 <a class="reference internal" href="#table-regular-arithmetic-functions"><span class="std std-numref">表 5</span></a> 所示。</p>
<span id="table-regular-arithmetic-functions"></span><table border="1" class="docutils" id="id6">
<caption><span class="caption-number">表 5 </span><span class="caption-text">常规算数运算函数</span><a class="headerlink" href="#id6" title="永久链接至表格">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="45%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">命令</th>
<th class="head">语法</th>
<th class="head">功能</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>add</td>
<td>( add v1 v2 … vn )</td>
<td>v1+v2+…+vn</td>
</tr>
<tr class="row-odd"><td>subtract</td>
<td>( subtract v1 v2 … vn )</td>
<td>v1-v2-…-vn</td>
</tr>
<tr class="row-even"><td>multiply</td>
<td>( multiply v1 v2 … vn )</td>
<td>v1*v2*…*vn</td>
</tr>
<tr class="row-odd"><td>divide</td>
<td>( divide v1 v2 … vn )</td>
<td>v1/v2/…/vn</td>
</tr>
<tr class="row-even"><td>absolute</td>
<td>( absolute v )</td>
<td>取绝对值</td>
</tr>
<tr class="row-odd"><td>abs</td>
<td>( abs v )</td>
<td>取绝对值</td>
</tr>
<tr class="row-even"><td>power</td>
<td>( power v )</td>
<td>取10的v次方</td>
</tr>
<tr class="row-odd"><td>alog10</td>
<td>( alog10 v)</td>
<td>以10为底取v的对数</td>
</tr>
<tr class="row-even"><td>alog</td>
<td>( alog v)</td>
<td>取v的自然对数</td>
</tr>
<tr class="row-odd"><td>exp</td>
<td>( exp v)</td>
<td>取e的v次方</td>
</tr>
<tr class="row-even"><td>sqrt</td>
<td>( sqrt v)</td>
<td>求v的平方根</td>
</tr>
<tr class="row-odd"><td>pi</td>
<td>( pi )</td>
<td>返回pi值</td>
</tr>
<tr class="row-even"><td>sine</td>
<td>( sine v )</td>
<td>正弦(v为弧度，下同)</td>
</tr>
<tr class="row-odd"><td>cosine</td>
<td>( cosine v )</td>
<td>余弦</td>
</tr>
<tr class="row-even"><td>tangent</td>
<td>( tangent v )</td>
<td>正切</td>
</tr>
<tr class="row-odd"><td>arcsine</td>
<td>( arcsine v )</td>
<td>反正弦</td>
</tr>
<tr class="row-even"><td>arccosine</td>
<td>( arccosine v )</td>
<td>反余弦</td>
</tr>
<tr class="row-odd"><td>arctangent</td>
<td>( arctangent v )</td>
<td>反正切</td>
</tr>
<tr class="row-even"><td>integer</td>
<td>( integer v )</td>
<td>取整</td>
</tr>
<tr class="row-odd"><td>maximum</td>
<td>( maximum v1 v2 … vn )</td>
<td>求最大值</td>
</tr>
<tr class="row-even"><td>minimum</td>
<td>( minimum v1 v2 … vn )</td>
<td>求最小值</td>
</tr>
</tbody>
</table>
<p>演示如下：</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAC</span><span class="o">&gt;</span> <span class="n">echo</span> <span class="n">on</span> <span class="n">processed</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var1</span> <span class="p">(</span><span class="n">add</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span>         <span class="c1"># 1+3+4</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var1</span> <span class="mi">8</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var2</span> <span class="p">(</span><span class="n">subtract</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span>    <span class="c1"># 1-3-4</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var2</span> <span class="o">-</span><span class="mi">6</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var3</span> <span class="p">(</span><span class="n">multiply</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span>    <span class="c1"># 1*3*4</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var3</span> <span class="mi">12</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var4</span> <span class="p">(</span><span class="n">divide</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span>      <span class="c1"># 1/3/4</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var4</span> <span class="mf">0.0833333</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var5</span> <span class="p">(</span><span class="n">absolute</span> <span class="o">-</span><span class="mf">5.1</span><span class="p">)</span>     <span class="c1"># abs(-5.1)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var5</span> <span class="mf">5.1</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var6</span> <span class="p">(</span><span class="n">power</span> <span class="mi">5</span><span class="p">)</span>           <span class="c1"># 10^5</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var6</span> <span class="mi">100000</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var7</span> <span class="p">(</span><span class="n">alog10</span> <span class="mi">10000</span><span class="p">)</span>      <span class="c1"># log10(10000)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var7</span> <span class="mi">4</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var8</span> <span class="p">(</span><span class="n">alog</span> <span class="mi">10000</span><span class="p">)</span>        <span class="c1"># ln(10000)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var8</span> <span class="mf">9.21034</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var9</span> <span class="p">(</span><span class="n">exp</span> <span class="mi">5</span><span class="p">)</span>             <span class="c1"># e^5</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var9</span> <span class="mf">148.413</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var10</span> <span class="p">(</span><span class="n">sqrt</span> <span class="mi">9</span><span class="p">)</span>           <span class="c1"># sqrt(9)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var10</span> <span class="mi">3</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var11</span> <span class="p">(</span><span class="n">pi</span><span class="p">)</span>               <span class="c1"># PI</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var11</span> <span class="mf">3.14159</span>
 <span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var12</span> <span class="p">(</span><span class="n">sine</span> <span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">))</span>     <span class="c1"># sin(30)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var12</span> <span class="mf">0.5</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var13</span> <span class="p">((</span><span class="n">arcsine</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var13</span> <span class="mi">30</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var14</span> <span class="p">(</span><span class="n">integer</span> <span class="mf">3.11</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var14</span> <span class="mi">3</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var15</span> <span class="p">(</span><span class="nb">max</span> <span class="mf">3.11</span> <span class="o">-</span><span class="mf">1.5</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># maximum 简写为 max</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var15</span> <span class="mi">5</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var16</span> <span class="p">(</span><span class="nb">min</span> <span class="mf">3.11</span> <span class="o">-</span><span class="mf">1.5</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># minimum 简写为 min</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var16</span> <span class="o">-</span><span class="mf">1.5</span>
</pre></div>
</div>
<p>为了对一组数据做归一化，首先要找到所有数据中的绝对最大值，如下：</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAC</span><span class="o">&gt;</span> <span class="n">r</span> <span class="n">file1</span> <span class="n">file2</span> <span class="n">file3</span> <span class="n">file4</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">echo</span> <span class="n">on</span> <span class="n">processed</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">vmax</span> <span class="p">(</span><span class="nb">max</span> <span class="o">&amp;</span><span class="mi">1</span><span class="p">,</span><span class="n">depmax</span><span class="o">&amp;</span> <span class="o">&amp;</span><span class="mi">2</span><span class="p">,</span><span class="n">depmax</span><span class="o">&amp;</span> <span class="o">&amp;</span><span class="mi">3</span><span class="p">,</span><span class="n">depmax</span><span class="o">&amp;</span> <span class="o">&amp;</span><span class="mi">4</span><span class="p">,</span><span class="n">depmax</span><span class="o">&amp;</span><span class="p">)</span>
 <span class="o">==&gt;</span> <span class="n">setbb</span> <span class="n">vmax</span> <span class="mf">1.87324</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">vmin</span> <span class="p">(</span><span class="nb">min</span> <span class="o">&amp;</span><span class="mi">1</span><span class="p">,</span><span class="n">depmin</span><span class="o">&amp;</span> <span class="o">&amp;</span><span class="mi">2</span><span class="p">,</span><span class="n">depmin</span><span class="o">&amp;</span> <span class="o">&amp;</span><span class="mi">3</span><span class="p">,</span><span class="n">depmin</span><span class="o">&amp;</span> <span class="o">&amp;</span><span class="mi">4</span><span class="p">,</span><span class="n">depmin</span><span class="o">&amp;</span><span class="p">)</span>
 <span class="o">==&gt;</span> <span class="n">setbb</span> <span class="n">vmin</span> <span class="o">-</span><span class="mf">2.123371</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">div</span> <span class="p">(</span> <span class="nb">max</span> <span class="p">(</span><span class="nb">abs</span> <span class="o">%</span><span class="n">vmax</span><span class="o">%</span><span class="p">)</span> <span class="p">(</span><span class="nb">abs</span> <span class="o">%</span><span class="n">vmin</span><span class="o">%</span><span class="p">)</span> <span class="p">)</span>      <span class="c1"># 嵌套</span>
 <span class="o">==&gt;</span>  <span class="n">div</span> <span class="mf">2.123371</span>
</pre></div>
</div>
<p>此例可以通过多重嵌套的方式在单个命令中完成，但上面的写法可读性更强。</p>
</div>
<div class="section" id="id4">
<h2>字符串操作函数<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<p>SAC 提供了若干个函数用于字符串的处理，如 <a class="reference internal" href="#table-string-operation-functions"><span class="std std-numref">表 6</span></a>
所示：</p>
<span id="table-string-operation-functions"></span><table border="1" class="docutils" id="id7">
<caption><span class="caption-number">表 6 </span><span class="caption-text">字符串操作函数</span><a class="headerlink" href="#id7" title="永久链接至表格">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="35%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">命令</th>
<th class="head">语法(简写形式)</th>
<th class="head">功能</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>change</td>
<td>( cha s1 s2 s3 )</td>
<td>在s3中用s1代替s2</td>
</tr>
<tr class="row-odd"><td>substring</td>
<td>( substring n1 n2 s )</td>
<td>取s中第n1到第n2个字符</td>
</tr>
<tr class="row-even"><td>delete</td>
<td>( del s1 s2 )</td>
<td>从s2中删去s1</td>
</tr>
<tr class="row-odd"><td>concatenate</td>
<td>( conc s1 s2 … sn )</td>
<td>将多个字符串拼接起来</td>
</tr>
<tr class="row-even"><td>before</td>
<td>( bef s1 s2)</td>
<td>得到s2中位于s1前的部分字符串</td>
</tr>
<tr class="row-odd"><td>after</td>
<td>( aft s1 s2 )</td>
<td>得到s2中位于s1后的部分字符串</td>
</tr>
<tr class="row-even"><td>reply</td>
<td>( rep s1 )</td>
<td>发送信息s1到终端并得到回应</td>
</tr>
</tbody>
</table>
<p>下面的例子展示了部分函数的用法：</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAC</span><span class="o">&gt;</span> <span class="n">echo</span> <span class="n">on</span> <span class="n">processed</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var1</span> <span class="p">(</span><span class="n">cha</span> <span class="n">short</span> <span class="n">long</span> <span class="s2">&quot;this is short&quot;</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var1</span> <span class="n">this</span> <span class="ow">is</span> <span class="n">long</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="nb">set</span> <span class="n">var2</span> <span class="p">(</span><span class="k">del</span> <span class="k">def</span> <span class="nf">abcdefghi</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="nb">set</span> <span class="n">var2</span> <span class="n">abcghi</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="nb">set</span> <span class="n">var4</span> <span class="p">(</span><span class="n">before</span> <span class="n">de</span> <span class="n">abcdefg</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="nb">set</span> <span class="n">var4</span> <span class="n">abc</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="nb">set</span> <span class="n">var4</span> <span class="p">(</span><span class="n">after</span> <span class="n">de</span> <span class="n">abcdefg</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="nb">set</span> <span class="n">var4</span> <span class="n">fg</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">fg</span> <span class="n">seis</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">month</span> <span class="p">(</span><span class="n">substring</span> <span class="mi">1</span> <span class="mi">3</span> <span class="o">&amp;</span><span class="mi">1</span><span class="p">,</span><span class="n">kzdate</span><span class="o">&amp;</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">month</span> <span class="n">MAR</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">val</span> <span class="s2">&quot;1234567890&quot;</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">message</span> <span class="p">(</span><span class="n">substring</span> <span class="mi">1</span> <span class="mi">5</span> <span class="o">%</span><span class="n">val</span><span class="o">%</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">message</span> <span class="mi">12345</span>
 <span class="mi">12345</span>
</pre></div>
</div>
<p>下面的例子展示 <code class="docutils literal notranslate"><span class="pre">concatenate</span></code> 函数的用法以及如何灵活定义标题：</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAC</span><span class="o">&gt;</span> <span class="n">fg</span> <span class="n">seis</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">echo</span> <span class="n">on</span> <span class="n">processed</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var</span> <span class="p">(</span><span class="n">conc</span> <span class="n">Seismogram</span> <span class="n">of</span> <span class="o">&amp;</span><span class="mi">1</span><span class="p">,</span><span class="n">kevnm</span><span class="o">&amp;</span> <span class="o">&amp;</span><span class="mi">1</span><span class="p">,</span><span class="n">kstnm</span><span class="o">&amp;</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var</span> <span class="n">SeismogramofK8108838CDV</span>                 <span class="c1"># 没有空格</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">var</span> <span class="p">(</span><span class="n">conc</span> <span class="s2">&quot;Seismogram of &quot;</span> <span class="o">&amp;</span><span class="mi">1</span><span class="p">,</span><span class="n">kevnm</span><span class="o">&amp;</span> <span class="s2">&quot; &quot;</span> <span class="o">&amp;</span><span class="mi">1</span><span class="p">,</span><span class="n">kstnm</span><span class="o">&amp;</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">var</span> <span class="n">Seismogram</span> <span class="n">of</span> <span class="n">K8108838</span> <span class="n">CDV</span>              <span class="c1"># 含空格</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">getbb</span> <span class="n">var</span>
 <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;Seismogram of K8108838 CDV&#39;</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">title</span> <span class="p">(</span><span class="n">conc</span> <span class="s2">&quot;Seismogram of &quot;</span> <span class="o">&amp;</span><span class="mi">1</span><span class="p">,</span><span class="n">kevnm</span><span class="o">&amp;</span> <span class="s2">&quot; &quot;</span> <span class="o">&amp;</span><span class="mi">1</span><span class="p">,</span><span class="n">kstnm</span><span class="o">&amp;</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">title</span> <span class="n">Seismogram</span> <span class="n">of</span> <span class="n">K8108838</span> <span class="n">CDV</span>                  <span class="c1"># 错误标题！</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">title</span> <span class="s1">&#39;(conc &quot;Seismogram of &quot; &amp;1,kevnm&amp; &quot; &quot; &amp;1,kstnm&amp;)&#39;</span>
 <span class="o">==&gt;</span>  <span class="n">title</span> <span class="s2">&quot;(conc &quot;</span><span class="n">Seismogram</span> <span class="n">of</span> <span class="s2">&quot; K8108838 &quot;</span> <span class="s2">&quot; CDV)&quot;</span>  <span class="c1"># 错误标题！</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">title</span> <span class="s2">&quot;Seismogram of &amp;1,kevnm&amp; &amp;1,kstnm&amp;&quot;</span>
 <span class="o">==&gt;</span>  <span class="n">title</span> <span class="s2">&quot;Seismogram of K8108838 CDV&quot;</span>                <span class="c1"># 正确标题！</span>
</pre></div>
</div>
<p>下面的例子使用 <code class="docutils literal notranslate"><span class="pre">reply</span></code> 函数实现了交互：</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAC</span><span class="o">&gt;</span> <span class="n">fg</span> <span class="n">seis</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">echo</span> <span class="n">on</span> <span class="n">processed</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">rmean</span><span class="p">;</span> <span class="n">rtr</span><span class="p">;</span> <span class="n">taper</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">low</span> <span class="p">(</span><span class="n">reply</span> <span class="s2">&quot;Enter low freqency limit for bandpass: &quot;</span><span class="p">)</span>
<span class="n">Enter</span> <span class="n">low</span> <span class="n">freqency</span> <span class="n">limit</span> <span class="k">for</span> <span class="n">bandpass</span><span class="p">:</span> <span class="mf">2.1</span>          <span class="c1"># 用户输入2.1</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">low</span> <span class="mf">2.1</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">high</span> <span class="p">(</span><span class="n">reply</span> <span class="s2">&quot;Enter low freqency limit for bandpass: &quot;</span><span class="p">)</span>
<span class="n">Enter</span> <span class="n">low</span> <span class="n">freqency</span> <span class="n">limit</span> <span class="k">for</span> <span class="n">bandpass</span><span class="p">:</span> <span class="mf">6.5</span>          <span class="c1"># 用户输入6.5</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">high</span> <span class="mf">6.5</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">bp</span> <span class="n">c</span> <span class="o">%</span><span class="n">low</span><span class="o">%</span> <span class="o">%</span><span class="n">high</span><span class="o">%</span>
 <span class="o">==&gt;</span>  <span class="n">bp</span> <span class="n">c</span> <span class="mf">2.1</span> <span class="mf">6.5</span>
</pre></div>
</div>
<p>下面的例子中 <code class="docutils literal notranslate"><span class="pre">reply</span></code> 函数包含了一个默认值值：</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">bbday</span> <span class="p">(</span><span class="n">reply</span> <span class="s2">&quot;Enter the day of the week: [Monday]&quot;</span><span class="p">)</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">day</span> <span class="n">of</span> <span class="n">the</span> <span class="n">week</span><span class="p">:</span> <span class="p">[</span><span class="n">Monday</span><span class="p">]</span><span class="n">Tuesday</span>      <span class="c1"># 用户输入Tuesday</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">getbb</span> <span class="n">bbday</span>
 <span class="n">bbday</span> <span class="o">=</span> <span class="s1">&#39;Tuesday&#39;</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">bbday</span> <span class="p">(</span><span class="n">reply</span> <span class="s2">&quot;Enter the day of the week: [Monday]&quot;</span><span class="p">)</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">day</span> <span class="n">of</span> <span class="n">the</span> <span class="n">week</span><span class="p">:</span> <span class="p">[</span><span class="n">Monday</span><span class="p">]</span>             <span class="c1"># 用户无输入</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">getbb</span> <span class="n">bbday</span>
 <span class="n">bbday</span> <span class="o">=</span> <span class="s1">&#39;Monday&#39;</span>
</pre></div>
</div>
<p>当 <code class="docutils literal notranslate"><span class="pre">reply</span></code> 函数执行时，引号中的字符串将出现在屏幕上，提示用户输入。如果用户输入，SAC 会将输入的字符串作为返回值，如果用户只是敲击回车键，SAC 则会使用该默认值“MONDAY”。</p>
</div>
<div class="section" id="id5">
<h2>其他函数<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<p>这类函数目前只有一个：<code class="docutils literal notranslate"><span class="pre">gettime</span></code>，其语法为 “<code class="docutils literal notranslate"><span class="pre">(gettime</span> <span class="pre">max</span></code>min
[value])|”。</p>
<p><code class="docutils literal notranslate"><span class="pre">gettime</span></code> 函数用于返回数据中首先出现大于或小于 value 的时间相对于文件参考时刻的相对时间；若没有指定 value，<code class="docutils literal notranslate"><span class="pre">max</span></code> 会返回文件中第一个最大值的相对时间，<code class="docutils literal notranslate"><span class="pre">min</span></code> 会返回文件中第一个最小值的相对时间。</p>
<p>对于所有的文件有一个最大振幅，要找到这些文件中第一个文件中第一次大于该值所对应的时间偏移量：</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAC</span><span class="o">&gt;</span> <span class="n">fg</span> <span class="n">seis</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">echo</span> <span class="n">on</span> <span class="n">processed</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">maxtime</span> <span class="p">(</span><span class="n">gettime</span> <span class="nb">max</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">maxtime</span> <span class="mf">12.55</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">mintime</span> <span class="p">(</span><span class="n">gettime</span> <span class="nb">min</span><span class="p">)</span>
 <span class="o">==&gt;</span>  <span class="n">setbb</span> <span class="n">mintime</span> <span class="mf">12.67</span>
</pre></div>
</div>
<p>为了找到第一个大于或等于1.0的数据点的时间偏移，可以使用如下命令：</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAC</span><span class="o">&gt;</span> <span class="n">fg</span> <span class="n">seis</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">echo</span> <span class="n">on</span> <span class="n">processed</span>
<span class="n">SAC</span><span class="o">&gt;</span> <span class="n">setbb</span> <span class="n">valuetime</span> <span class="p">(</span> <span class="n">gettime</span> <span class="nb">max</span> <span class="mf">1.0</span> <span class="p">)</span>
 <span class="o">==&gt;</span> <span class="n">setbb</span> <span class="n">valuatime</span> <span class="mf">10.55</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../macros/" class="btn btn-neutral float-right" title="SAC 宏" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../blackboard-variables/" class="btn btn-neutral" title="黑板变量" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2018, SeisMan.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'4.0-dev',
            LANGUAGE:'zh_CN',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>